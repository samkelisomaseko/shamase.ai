<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Fluid BlueDrop Animation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Physics2DPlugin.min.js"></script>
  <script src="https://hammerjs.github.io/dist/hammer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Oxanium:wght@500&family=Rajdhani:wght@700&family=Syncopate:wght@700&family=Audiowide&display=swap" rel="stylesheet">
  <style>
    /* Global styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: all 0.3s ease-in-out;
    }

    body {
      font-family: 'Rajdhani', sans-serif;
      min-height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      color: var(--text-color);
      background: var(--bg-gradient);
      padding: 20px;
    }

    /* Root variables for theming */
    :root {
      --bg-gradient: radial-gradient(circle, #14161A, #000);
      --text-color: #ffffff;
      --button-bg: #333;
      --button-shadow: #111;
      --primary-color: #0077ff;
         --waveform-color-1: #4a86e8;
        --waveform-color-2: #d36582;
        --waveform-color-3: #9248cc;
    }

    /* Light mode variables */
    .light-mode {
      --bg-gradient: radial-gradient(circle, #ffffff, #f3f3f3);
      --text-color: #000000;
      --button-bg: #e0e0e0;
      --button-shadow: #cccccc;
      --primary-color: #0077ff;
         --waveform-color-1: #0077ff;
        --waveform-color-2: #ff0077;
         --waveform-color-3: #00ff99;
    }

    /* Main content styles */
    .content {
      width: 90%;
      max-width: 800px;
      text-align: center;
      margin: clamp(20px, 5vh, 40px) auto;
      padding: clamp(15px, 3vw, 30px);
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      color: var(--text-color);
      font-family: 'Audiowide', sans-serif;
      transition: transform 0.3s ease-in-out, filter 0.3s ease-in-out;
    }

    .content h1 {
      font-size: clamp(1.8rem, 4vw, 3rem);
      margin-bottom: clamp(10px, 2vw, 20px);
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
    }

    .content p {
      font-size: clamp(1rem, 2.5vw, 1.2rem);
      font-weight: 300;
      line-height: 1.6;
    }

    /* Siri-like animation styles */
     .siri-animation {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1000;
          pointer-events: none;
          overflow: hidden;
          perspective: 1000px;
          display: none; /* Initially hidden */
           background: rgba(0, 0, 0, 0.7); /* Transparent dark overlay */
      }

        .siri-animation.active {
            display: flex;
            align-items: center;
            justify-content: center;
          }


    .wave {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      opacity: 0;
      filter: blur(40px);
      transform-style: preserve-3d;
    }
      .waveform-container {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
            width: 80%;
          height: 20%;
          display: flex;
          justify-content: center;
          align-items: center;
          overflow: hidden;
        }

        .waveform-bar {
          width: 3px;
          height: 10%;
           background: linear-gradient(var(--waveform-color-1), var(--waveform-color-2), var(--waveform-color-3));
          margin: 0 4px;
          border-radius: 2px;
        }

         .context-icon {
              position: absolute;
                top: 30%;
                left: 50%;
                transform: translate(-50%, -50%);
              font-size: 80px;
              color: white;
              opacity: 0;
              transition: opacity 0.3s ease, transform 0.3s ease;
              text-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
          }

          .live-transcription {
              position: absolute;
              bottom: 10%;
              left: 50%;
              transform: translateX(-50%);
              width: 80%;
              text-align: center;
              color: white;
              font-size: 1.2rem;
              font-family: 'Rajdhani', sans-serif;
              opacity: 0;
              transition: opacity 0.3s ease, transform 0.3s ease;
              max-height: 100px;
              overflow-y: auto;
               text-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
          }



    /* Edge lighting styles */
    .edge-light {
      position: fixed;
      opacity: 0;
      z-index: 1001;
      filter: blur(5px);
      background: linear-gradient(45deg, 
        #ff3f34, #ff9d00, #f3e200, #00d6b6, #0099ff, #9a00ff, #ff3f34
      );
      background-size: 200% 200%;
      animation: rainbowPulse 3s ease-in-out infinite, edgeGlow 1s ease-in-out infinite;
    }

    @keyframes rainbowPulse {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes edgeGlow {
      0% { filter: blur(5px) brightness(1); }
      50% { filter: blur(10px) brightness(2); }
      100% { filter: blur(5px) brightness(1); }
    }

    .edge-light-top, .edge-light-bottom {
      left: 0;
      right: 0;
      height: 12px;
    }

    .edge-light-left, .edge-light-right {
      top: 0;
      bottom: 0;
      width: 12px;
    }

    .edge-light-top {
      top: 0;
      border-top-left-radius: 20px;
      border-top-right-radius: 20px;
    }

    .edge-light-bottom {
      bottom: 0;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
    }

    .edge-light-left {
      left: 0;
      border-top-left-radius: 20px;
      border-bottom-left-radius: 20px;
    }

    .edge-light-right {
      right: 0;
      border-top-right-radius: 20px;
      border-bottom-right-radius: 20px;
    }

    /* Settings panel styles */
    .settings-panel {
      position: absolute;
      bottom: 20px;
      width: 90%;
      max-width: 400px;
      padding: 20px;
      backdrop-filter: blur(20px);
      background: rgba(255, 255, 255, 0.15);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      color: var(--text-color);
      font-family: 'Audiowide', sans-serif;
      transition: transform 0.3s ease-in-out, filter 0.3s ease-in-out;
    }

    .settings-panel h2 {
      font-size: 1.5rem;
      margin-bottom: 20px;
      text-align: center;
    }

    .settings-option {
      margin: 10px 0;
    }

    .settings-option button {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      text-transform: uppercase;
      background: var(--button-bg);
      color: var(--text-color);
      outline: none;
      box-shadow: 3px 3px 8px var(--button-shadow), -3px -3px 8px rgba(255, 255, 255, 0.2);
      cursor: pointer;
      transition: transform 0.2s ease-in-out, background 0.3s ease-in-out;
    }

    .settings-option button:hover {
      background: linear-gradient(45deg, #0077ff, #ff0077);
      color: #fff;
      transform: translateY(-2px);
    }

    .settings-option button:active {
      transform: translateY(2px);
    }

    /* Dynamic Island Styles */
    #dynamicIsland {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #1a1a2e, #16213e);
      border-radius: 30px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(12px);
      min-height: 80px;
      width: 320px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.4s ease-in-out;
      z-index: 1000;
    }

    /* Collapsed Content Styles */
    #collapsedContent {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      padding: 12px 22px;
    }

    #collapsedContent img {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      box-shadow: 0 4px 10px rgba(255, 255, 255, 0.2);
    }

    #collapsedContent span {
      font-size: 1.1rem;
      font-weight: 600;
      color: #fff;
    }

    /* Expanded Content Styles */
    #expandedContent {
      display: none;
      flex-direction: column;
      gap: 12px;
      padding: 25px;
    }

    .module {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 15px;
      padding: 18px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      position: relative;
      transition: all 0.4s ease;
    }

    .module:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: scale(1.02);
    }

    .module-icon {
      width: 55px;
      height: 55px;
      border-radius: 50%;
      background: linear-gradient(45deg, #ff512f, #dd2476);
      display: flex;
      justify-content: center;
      align-items: center;
      color: #fff;
      font-size: 1.6rem;
    }

    .module-details {
      display: flex;
      flex-direction: column;
    }

    .module-title {
      font-size: 1.1rem;
      font-weight: bold;
      color: #ffffff;
    }

    .module-subtitle {
      font-size: 0.9rem;
      color: #ccc;
    }

    .expanded-content {
      color: #ffffff;
    }

    .ripple {
      position: absolute;
      width: 100px;
      height: 100px;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 50%;
      transform: scale(0);
      animation: rippleEffect 1s ease-out;
      pointer-events: none;
    }

    @keyframes rippleEffect {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    #blueDropButton {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      text-transform: uppercase;
      background: var(--button-bg);
      color: var(--text-color);
      outline: none;
      box-shadow: 3px 3px 8px var(--button-shadow), -3px -3px 8px rgba(255, 255, 255, 0.2);
      cursor: pointer;
      transition: transform 0.2s ease-in-out, background 0.3s ease-in-out;
    }

    #blueDropButton:hover {
      background: linear-gradient(45deg, #0077ff, #ff0077);
      color: #fff;
      transform: translateY(-2px);
    }

    #blueDropButton:active {
      transform: translateY(2px);
    }

    /* Update existing BlueDrop Animation Styles */
#blueDropAnimation {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

.bluedrop-container {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  width: 320px;
  height: 320px;
  background: #ffffff;
  border-radius: 30px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  overflow: hidden;
}

.bluedrop-container .fluid {
  width: 150%;
  height: 150%;
  transform: scale(0.8) translateY(20%);
}

#fluidCanvas {
  position: absolute;
  top: 0;
  left: 0;
}

.fluid {
  position: absolute;
  width: 150%;
  height: 150%;
  background: linear-gradient(135deg, 
    rgba(0, 122, 255, 0.8),
    rgba(88, 86, 214, 0.8),
    rgba(255, 45, 85, 0.8)
  );
  border-radius: 30px;
  filter: blur(20px);
  opacity: 0.8;
  transform: scale(0.8) translateY(20%);
}

.fluid::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/png;base64,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UmVhZHlxyWU8AAADKGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphZmZkOWYzZC1hNzQ1LTRlNzQtYWQwZC0zNzg4NDJjZmFiMTEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTFCNTY0N0Y5RUJGMTFFQTlDMTNERTM0MkZBRTY5NjgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTFCNTY0N0U5RUJGMTFFQTlDMTNERTM0MkZBRTY5NjgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YWZmZDlmM2QtYTc0NS00ZTc0LWFkMGQtMzc4ODQyY2ZhYjExIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFmZmQ5ZjNkLWE3NDUtNGU3NC1hZDBkLTM3ODg0MmNmYWIxMSIvPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==');
  background-blend-mode: overlay;
  mix-blend-mode: overlay;
}

.bluedrop-content {
  position: relative;
  z-index: 1;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: white;
  font-family: 'Orbitron', sans-serif;
}

.bluedrop-message {
  opacity: 1;
  font-family: 'Rajdhani', sans-serif;
  font-size: 20px;
  text-transform: uppercase;
  letter-spacing: 2px;
  transition: opacity 0.3s ease, transform 0.5s ease;
}

.bluedrop-success-message,
.bluedrop-error-message,
.bluedrop-loading-message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 28px;
  font-weight: bold;
  color: #ffffff;
  opacity: 0;
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.bluedrop-success-message {
  font-family: 'Orbitron', sans-serif;
  color: #4CAF50;
}

.bluedrop-error-message {
  font-family: 'Exo', sans-serif;
  color: #F44336;
}

.bluedrop-loading-message {
  font-family: 'Rajdhani', sans-serif;
  color: #2196F3;
  animation: loadingText 1.5s infinite ease-in-out;
}

.bluedrop-retry-button {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 24px;
  background-color: #343A40;
  color: #ffffff;
  border: 2px solid #4CAF50;
  border-radius: 10px;
  font-size: 16px;
  font-family: 'Rajdhani', sans-serif;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  opacity: 0;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease;
}

.bluedrop-retry-button:hover {
  transform: translate(-50%, -2px) scale(1.02);
  background-color: #3E4349;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
}

@keyframes loadingText {
  0% { transform: translate(-50%, -50%); }
  25% { transform: translate(-50%, -48%); }
  50% { transform: translate(-50%, -50%); }
  75% { transform: translate(-50%, -52%); }
  100% { transform: translate(-50%, -50%); }
}


    .bluedrop-button {
      padding: 10px 20px;
      font-size: 1rem;
      background: linear-gradient(45deg, #0077ff, #ff0077);
      border: none;
      border-radius: 30px;
      color: white;
      cursor: pointer;
      transition: transform 0.2s ease-in-out;
    }

    .bluedrop-button:hover {
      transform: scale(1.05);
    }

    .bluedrop-close {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      color: white;
      cursor: pointer;
      background: none;
      border: none;
    }
  
  
  
  
  
    /* Settings Icon */
    .settings-icon {
      background: linear-gradient(145deg, #e6e9ef, #ffffff);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 4px 4px 10px #c7c9d1, -4px -4px 10px #ffffff;
      transition: all 0.3s ease;
      z-index:10;
    }

    .settings-icon:active {
      transform: scale(0.95);
      box-shadow: inset 4px 4px 6px #c7c9d1, inset -4px -4px 6px #ffffff;
    }

    .settings-icon::before {
      content: '‚öôÔ∏è';
      font-size: 2.8rem;
      color: #6c757d;
    }

    /* Popup Container */
    .popup-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.7);
      background: #ffffff;
      border-radius: 20px;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      width: 350px;
      text-align: center;
      padding: 25px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      z-index:1000;
    }

    .popup-container.show {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
      visibility: visible;
    }

    h3 {
      margin: 0 0 15px;
      color: #333;
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4rem;
      letter-spacing: 1px;
    }

    /* Toggle Buttons */
    .toggle-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 10px;
    }

    .toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(145deg, #f0f3f7, #ffffff);
      border-radius: 12px;
      padding: 12px 20px;
      box-shadow: 4px 4px 10px #c7c9d1, -4px -4px 10px #ffffff;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
    }

    .toggle:hover {
      transform: scale(1.02);
    }

    .toggle-label {
      font-size: 1.2rem;
      color: #555;
      font-family: 'Rajdhani', sans-serif;
      font-weight: 600;
    }

    .toggle-button {
      width: 55px;
      height: 30px;
      background-color: #ddd;
      border-radius: 25px;
      position: relative;
      transition: background-color 0.3s;
      box-shadow: inset 2px 2px 5px #bbb, inset -2px -2px 5px #ffffff;
    }

    .toggle-button::before {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      width: 24px;
      height: 24px;
      background: linear-gradient(145deg, #e6e9ef, #ffffff);
      border-radius: 50%;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      box-shadow: 2px 2px 4px #c7c9d1, -2px -2px 4px #ffffff;
    }

    .toggle.active .toggle-button {
      background-color: #4cd964;
      box-shadow: inset 2px 2px 5px #3cbf54, inset -2px -2px 5px #5ef176;
    }

    .toggle.active .toggle-button::before {
      transform: translateX(25px) scale(1.1);
    }

    .toggle.active .toggle-label {
      color: #4cd964;
    }

    /* Close Button */
    .close-btn {
      margin-top: 20px;
      background: #ff3b30;
      border: none;
      color: #fff;
      border-radius: 12px;
      padding: 10px 20px;
      font-size: 1rem;
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 0.5px;
      cursor: pointer;
      box-shadow: 4px 4px 8px #c13228, -4px -4px 8px #ff5a4f;
      transition: all 0.3s;
    }

    .close-btn:hover {
      transform: scale(1.05);
      background: #d62c23;
    }
  </style>
</head>
<body>
  <!-- Main Content -->
  <div class="content" id="mainContent">
    <h1>Welcome To Shamase Animation</h1>
    <p>Experience the next-level interactive animation!</p>
    <!-- BlueDrop Button -->
    <button id="blueDropButton">BlueDrop</button>
  </div>

  <!-- Siri-like Animation -->
  <div class="siri-animation" id="siriAnimation">
        <div class="waveform-container" id="waveformContainer"></div>
          <div class="context-icon" id="contextIcon"></div>
      <div class="live-transcription" id="liveTranscription"></div>
      </div>
  <div class="edge-light edge-light-top" id="edgeLightTop"></div>
  <div class="edge-light edge-light-bottom" id="edgeLightBottom"></div>
  <div class="edge-light edge-light-left" id="edgeLightLeft"></div>
  <div class="edge-light edge-light-right" id="edgeLightRight"></div>

  <div id="dynamicIsland">
    <!-- Collapsed Content -->
    <div id="collapsedContent">
      <img id="latestIcon" src="https://via.placeholder.com/50" alt="Notification Icon">
      <span id="latestText">Dynamic Island</span>
    </div>

    <!-- Expanded Content -->
    <div id="expandedContent">
      <!-- Music Module -->
      <div class="module" data-app="Music">
        <div class="module-icon">üéµ</div>
        <div class="module-details">
          <div class="module-title">Now Playing</div>
          <div class="module-subtitle">"Shape of You" - Ed Sheeran</div>
          <div class="expanded-content">Volume: 75% | Play | Pause | Skip</div>
        </div>
      </div>

      <!-- Timer Module -->
      <div class="module" data-app="Timer">
        <div class="module-icon">‚è≤</div>
        <div class="module-details">
          <div class="module-title">Timer</div>
          <div class="module-subtitle">00:15:32</div>
          <div class="expanded-content">Reset | Add 5 mins | Stop</div>
        </div>
      </div>

      <!-- Call Module -->
      <div class="module" data-app="Call">
        <div class="module-icon">üìû</div>
        <div class="module-details">
          <div class="module-title">Active Call</div>
          <div class="module-subtitle">Shamase</div>
          <div class="expanded-content">Mute | Speaker | End Call</div>
        </div>
      </div>

      <!-- Live Activity -->
      <div class="module" data-app="Activity">
        <div class="module-icon">üèÄ</div>
        <div class="module-details">
          <div class="module-title">Live Scores</div>
          <div class="module-subtitle">Team A: 78 - Team B: 84</div>
          <div class="expanded-content">View Details</div>
        </div>
      </div>
    </div>
  </div>
  

  <!-- Popup Container -->
  <div class="popup-container" id="popup">
    <h3>Settings</h3>
    <div class="toggle-container">
      <div class="toggle" id="dynamic-toggle">
        <span class="toggle-label">Dynamic Island</span>
        <div class="toggle-button"></div>
      </div>
      <div class="toggle" id="bluedrop-toggle">
        <span class="toggle-label">BlueDrop</span>
        <div class="toggle-button"></div>
      </div>
      <div class="toggle" id="siri-toggle">
        <span class="toggle-label">Siri Animation</span>
        <div class="toggle-button"></div>
      </div>
    </div>
    <button class="close-btn" id="close-btn">Close</button>
  </div>


  <!-- Settings Panel -->
  <div class="settings-panel" id="settingsPanel">
    <h2>Settings</h2>
    <div class="settings-option">
      <button id="themeToggle">Toggle Theme</button>
    </div>
    <div class="settings-option">
      <button id="notificationPermission">Enable Notifications</button>
    </div>
    <div class="settings-option">
      <button id="accessibilityCheck">Enable Accessibility</button>
    </div>
    <div class="settings-option">
      <button id="settings-icon">Disable Each</button>
    </div>
    <div class="settings-option">
      <button onclick="triggerSiriAnimation()">Test Animation</button>
    </div>
  </div>

  <!-- Add this inside the existing BlueDrop Animation div -->
<div id="blueDropAnimation">
  <div class="bluedrop-container">
    <canvas id="fluidCanvas"></canvas>
    <div class="fluid" id="fluidBackground"></div>
    <div class="bluedrop-content">
      <div class="bluedrop-message" id="bluedropMessage">Tap to start BlueDrop</div>
      <div class="bluedrop-success-message" id="bluedropSuccessMessage">Transfer Complete!</div>
      <div class="bluedrop-error-message" id="bluedropErrorMessage">Transfer Failed</div>
      <div class="bluedrop-loading-message" id="bluedropLoadingMessage">Transferring...</div>
      <button class="bluedrop-retry-button" id="bluedropRetryButton">Retry</button>
    </div>
  </div>
  <button class="bluedrop-close" id="blueDropClose">√ó</button>
</div>


  
  <script>
  /* Global variables */
    const siriAnimation = document.getElementById('siriAnimation');
     const waveformContainer = document.getElementById('waveformContainer');
     const contextIcon = document.getElementById('contextIcon');
     const liveTranscription = document.getElementById('liveTranscription');
    const edgeLights = [
      document.getElementById('edgeLightTop'),
      document.getElementById('edgeLightBottom'),
      document.getElementById('edgeLightLeft'),
      document.getElementById('edgeLightRight')
    ];
    const mainContent = document.getElementById('mainContent');
    const settingsPanel = document.getElementById('settingsPanel');
    const themeToggle = document.getElementById('themeToggle');
    const notificationPermission = document.getElementById('notificationPermission');
    const accessibilityCheck = document.getElementById('accessibilityCheck');
    let isLightMode = false;
    let isAnimating = false;

    /* Dynamic Island functionality */
    const dynamicIsland = document.getElementById('dynamicIsland');
    const collapsedContent = document.getElementById('collapsedContent');
    const expandedContent = document.getElementById('expandedContent');

    // Update the latest notification
    let latestNotification = { app: "Music", icon: "üéµ", text: "Now Playing: Shape of You" };
    function updateLatestNotification(notification) {
      latestNotification = notification;
      document.getElementById('latestIcon').src = `https://via.placeholder.com/50?text=${notification.icon}`;
      document.getElementById('latestText').textContent = notification.text;
    }
    updateLatestNotification(latestNotification);

    // Expand/Collapse the Dynamic Island
     let isIslandExpanded = false;
    collapsedContent.addEventListener('click', () => {
      if (!isIslandExpanded) {
        gsap.to(dynamicIsland, { height: "auto", width: 350, duration: 0.5, ease: "power2.out" });
        collapsedContent.style.display = "none";
        expandedContent.style.display = "flex";
        isIslandExpanded = true;
      }
    });

    document.body.addEventListener('click', (e) => {
      if (isIslandExpanded && !dynamicIsland.contains(e.target)) {
        gsap.to(dynamicIsland, { height: 70, width: 300, duration: 0.5, ease: "power2.in" });
        collapsedContent.style.display = "flex";
        expandedContent.style.display = "none";
        isIslandExpanded = false;
      }
    });

    /* Siri-like animation functionality */
    function createFluidWave(color, index) {
        const wave = document.createElement('div');
        wave.className = 'wave';
        siriAnimation.appendChild(wave);
    
        const size = Math.random() * 100 + 150;
        const startX = Math.random() * window.innerWidth;
        const startY = Math.random() * window.innerHeight;
        const startZ = Math.random() * 100 - 50;
        const initialRotation = Math.random() * 360;
    
        gsap.set(wave, {
            width: size,
            height: size,
            x: startX,
            y: startY,
            z: startZ,
            rotation: initialRotation, // Set initial rotation
            background: `radial-gradient(circle, ${color}66 0%, ${color}00 70%)`,
            opacity: 0,
            filter: 'blur(20px)'
        });
    
        return wave;
    }
    

    function animateFluidWave(wave, index) {
    const duration = 4 + Math.random() * 2;
    const delay = index * 0.1;
    const endRotation = Math.random() * 360;
    
    const timeline = gsap.timeline();

    timeline.to(wave, {
        opacity: 0.7,
        duration: 0.5,
        ease: 'power2.inOut',
    }, delay);

    timeline.to(wave, {
            motionPath: {
                path: [
                    { x: Math.random() * 100 - 50, y: Math.random() * 100 - 50, z: Math.random() * 50 - 25 },
                    { x: Math.random() * 200 - 100, y: Math.random() * 200 - 100, z: Math.random() * 100 - 50 },
                    { x: Math.random() * 100 - 50, y: Math.random() * 100 - 50, z: Math.random() * 50 - 25 },
                ],
                curviness: 1.2,
            },
            scale: 1.2,
            rotation: endRotation, // Rotate to endRotation
            duration: duration,
            ease: 'power3.out',
        }, delay);

    timeline.to(wave, {
        opacity: 0,
        scale: 1.8,
        duration: 0.8,
        ease: 'power2.in',
        onComplete: () => {
            wave.remove();
        },
    }, `>-0.5`);

        return timeline;
    }
    

    function triggerHapticFeedback() {
      if ('vibrate' in navigator) {
        navigator.vibrate([15, 30, 15]);
      }
    }
    
    function animateEdgeLight(element, delay) {
      gsap.to(element, {
        opacity: 1,
        duration: 0.6,
        ease: 'power2.inOut',
        yoyo: true,
        repeat: 1,
        delay: delay,
        onComplete: () => {
            gsap.to(element, {
                opacity: 0,
                duration: 0.4,
                ease: 'power2.inOut',
            });
        },
      });
  }
       function createWaveformBars() {
           waveformContainer.innerHTML = '';
           const numBars = 30;
           for (let i = 0; i < numBars; i++) {
               const bar = document.createElement('div');
               bar.className = 'waveform-bar';
               waveformContainer.appendChild(bar);
           }
        }


    function animateWaveform() {
            const bars = document.querySelectorAll('.waveform-bar');
            bars.forEach((bar, index) => {
              const delay = index * 0.05;
              const randomHeight = Math.random() * 0.5 + 0.5; // Random height between 0.5 and 1
              const randomDelay = delay + (Math.random() * 0.2 - 0.1); // Slight random delay
              const tl = gsap.timeline({ repeat: -1, });
                tl.to(bar, {
                    scaleY: randomHeight,
                    duration: 0.3,
                   ease: 'power2.inOut',
                     delay: randomDelay,
                });
            });
    }

  
  function triggerSiriAnimation(query) {
      if (isAnimating) return;
      isAnimating = true;
       siriAnimation.classList.add('active');
       siriAnimation.style.display = 'flex';
      triggerHapticFeedback();
    
    
        // Create and animate the waveform
            createWaveformBars();
            animateWaveform();


       // Set context-aware icon and transciption if present
      let icon = '';
       if (query && query.toLowerCase().includes('weather')) {
        icon = '‚òÄÔ∏è';
       } else if (query && query.toLowerCase().includes('music')) {
         icon = 'üéµ';
       }
       contextIcon.textContent = icon;

         if (query) {
            liveTranscription.textContent = query;
          } else {
            liveTranscription.textContent = '';
         }

       gsap.to([contextIcon, liveTranscription], {
           opacity: 1,
            duration: 0.4,
             ease: 'power2.inOut',
            });
  
      siriAnimation.innerHTML = '';
      siriAnimation.appendChild(waveformContainer);
      siriAnimation.appendChild(contextIcon);
       siriAnimation.appendChild(liveTranscription);
  
      gsap.to([mainContent, settingsPanel], {
          scale: 0.98,
          filter: 'blur(3px)',
          duration: 0.2,
          ease: 'power2.inOut',
      });
  
      const colors = [
          getComputedStyle(document.documentElement).getPropertyValue('--primary-color'),
          '#ff0077',
          '#00ff99',
          '#ffcc00'
      ];
      const totalWaves = 15;
  
      for (let i = 0; i < totalWaves; i++) {
          const wave = createFluidWave(colors[i % colors.length], i);
          animateFluidWave(wave, i);
      }
  
      // Animate edge lights with staggered delays
      animateEdgeLight(edgeLights[0], 0); // Top
      animateEdgeLight(edgeLights[1], 0.1); // Bottom
      animateEdgeLight(edgeLights[2], 0.2); // Left
      animateEdgeLight(edgeLights[3], 0.3); // Right
  
      gsap.to([mainContent, settingsPanel], {
          scale: 1,
          filter: 'blur(0px)',
          duration: 0.3,
          delay: 4,
          ease: 'power2.inOut',
          onComplete: () => {
             siriAnimation.classList.remove('active');
              gsap.to([contextIcon, liveTranscription], {
                 opacity: 0,
                  duration: 0.2,
                   ease: 'power2.inOut',
                 });
              siriAnimation.style.display = 'none';
            
              isAnimating = false;
            waveformContainer.innerHTML = '';
             gsap.set('.waveform-bar', { clearProps: 'all' });
          },
      });
  }

    themeToggle.addEventListener('click', () => {
      isLightMode = !isLightMode;
      document.body.classList.toggle('light-mode', isLightMode);
      themeToggle.textContent = isLightMode ? 'Dark Mode' : 'Light Mode';
    });

    notificationPermission.addEventListener('click', () => {
      if ('Notification' in window) {
        Notification.requestPermission().then((permission) => {
          if (permission === 'granted') {
            new Notification('Notifications Enabled!', {
              body: 'You can now receive notifications.',
            });
          } else {
            alert('Notification permission denied.');
          }
        });
      } else {
        alert('Notifications are not supported in this browser.');
      }
    });

    accessibilityCheck.addEventListener('click', () => {
      alert(
        'To enable accessibility, navigate to your device settings and grant accessibility permissions for this app.'
      );
    });

    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    document.body.classList.toggle('light-mode', !prefersDark.matches);

    siriAnimation.addEventListener('pointermove', (event) => {
      const { clientX, clientY } = event;
      const { left, top, width, height } = siriAnimation.getBoundingClientRect();
      const x = (clientX - left) / width - 0.5;
      const y = (clientY - top) / height - 0.5;

      gsap.to('.wave', {
        x: `+=${x * 50}`,
        y: `+=${y * 50}`,
        duration: 1,
        ease: 'power2.out',
      });
    });

    function simulateNotification() {
        const queries = [
             'What\'s the weather like today?',
            'Play my favorite playlist',
            'Remind me to take out the trash',
             'Set a timer for 15 minutes',
              'Call Shamase'
          ]
      const randomQuery = queries[Math.floor(Math.random() * queries.length)];
      triggerSiriAnimation(randomQuery);
      new Notification('New Message', {
        body: 'You have received a new message.',
      });
    }

    setInterval(simulateNotification, 30000);

    /* Swipe-to-dismiss functionality for Dynamic Island Modules */
    const modules = document.querySelectorAll('.module');
    
    modules.forEach((module) => {
      const hammer = new Hammer(module);

      // Enable swipe-to-dismiss feature
        hammer.on('swipe', (e) => {
            gsap.to(module, {
            x: e.deltaX > 0 ? 500 : -500,
            opacity: 0,
            duration: 0.5,
            ease: 'power3.out',
            onComplete: () => {
                module.remove();
            },
        });
      });
        

      // Long press to trigger an alert for module-specific actions
      hammer.on('press', () => {
        alert(`Opening ${module.dataset.app}`);
      });

      // Double-click to expand the module
      let clickCount = 0;
      module.addEventListener('click', () => {
        clickCount++;
        setTimeout(() => (clickCount = 0), 400);
        if (clickCount === 2) {
          module.classList.toggle('expanded');
        }
      });
    });

    // Add these variables at the beginning of your script
const bluedropMessage = document.getElementById('bluedropMessage');
const bluedropSuccessMessage = document.getElementById('bluedropSuccessMessage');
const bluedropErrorMessage = document.getElementById('bluedropErrorMessage');
const bluedropLoadingMessage = document.getElementById('bluedropLoadingMessage');
const bluedropRetryButton = document.getElementById('bluedropRetryButton');
const fluidCanvas = document.getElementById('fluidCanvas');
const ctx = fluidCanvas.getContext('2d');

let animationFrameId;
let particles = [];
let isBlueDropActive = false;

const startSound = new Howl({
  src: ['https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3']
});

const successSound = new Howl({
  src: ['https://assets.mixkit.co/sfx/preview/mixkit-magical-soft-sweep-2014.mp3']
});

const errorSound = new Howl({
  src: ['https://assets.mixkit.co/sfx/preview/mixkit-alert-quick-chime-766.mp3']
});

function resizeCanvas() {
  fluidCanvas.width = fluidCanvas.offsetWidth;
  fluidCanvas.height = fluidCanvas.offsetHeight;
  initParticles();
}

function initParticles() {
  particles = [];
  const particleCount = 150;
  for (let i = 0; i < particleCount; i++) {
    particles.push({
      x: Math.random() * fluidCanvas.width,
      y: Math.random() * fluidCanvas.height,
      radius: Math.random() * 2 + 1,
      color: `hsla(${Math.random() * 360}, 100%, 60%, ${Math.random() * 0.8 + 0.2})`,
      vx: Math.random() * 1 - 0.5,
      vy: Math.random() * 1 - 0.5,
      gravity: 0.02,
      alpha: 1,
    });
  }
}

function drawParticles() {
  ctx.clearRect(0, 0, fluidCanvas.width, fluidCanvas.height);
  particles.forEach(particle => {
    ctx.beginPath();
    ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
    ctx.fillStyle = particle.color;
    ctx.fill();

    particle.x += particle.vx;
    particle.y += particle.vy;
    particle.vy += particle.gravity;
    particle.alpha -= 0.01;

    if (particle.x < 0 || particle.x > fluidCanvas.width) particle.vx *= -1;
    if (particle.y < 0 || particle.y > fluidCanvas.height) {
      particle.y = fluidCanvas.height;
      particle.vy *= -0.5;
    }

    if (particle.alpha <= 0) {
      particle.x = Math.random() * fluidCanvas.width;
      particle.y = Math.random() * fluidCanvas.height;
      particle.alpha = 1;
      particle.vy = Math.random() * 1 - 0.5;
    }
  });

  animationFrameId = requestAnimationFrame(drawParticles);
}

function animateFluid() {
  gsap.to(fluidBackground, {
    rotation: 360,
    duration: 20,
    repeat: -1,
    ease: 'none',
  });
  gsap.to(fluidBackground, {
    scale: 1.2,
    duration: 4,
    repeat: -1,
    yoyo: true,
    ease: 'sine.inOut',
  });
}

function startBlueDrop() {
  blueDropAnimation.style.display = 'flex';
  resizeCanvas();
  drawParticles();
  animateFluid();
  isBlueDropActive = true;
}

function stopBlueDrop() {
  blueDropAnimation.style.display = 'none';
  cancelAnimationFrame(animationFrameId);
  isBlueDropActive = false;
  gsap.set(fluidBackground, { clearProps: 'all' });
  gsap.set(bluedropMessage, { opacity: 1 });
  gsap.to([bluedropSuccessMessage, bluedropErrorMessage, bluedropRetryButton], {
    opacity: 0,
    scale: 0.8,
    duration: 0.5,
    ease: 'power2.inOut',
  });
}

async function startTransfer() {
  if (isAnimating) return;
  isAnimating = true;

  startSound.play();

  gsap.to(bluedropMessage, {
    opacity: 0,
    duration: 0.3,
  });
  gsap.to(fluidBackground, {
    scale: 1.5,
    opacity: 1,
    duration: 0.5,
    ease: 'power2.inOut',
  });
  gsap.to(bluedropLoadingMessage, {
    opacity: 1,
    scale: 1,
    duration: 0.5,
    ease: 'back.out(1.7)',
  });
  await new Promise(resolve => setTimeout(resolve, 2000));

  const isSuccess = Math.random() > 0.2;
  gsap.to(bluedropLoadingMessage, {
    opacity: 0,
    scale: 0.8,
    duration: 0.5,
    ease: 'power2.inOut',
  });

  if (isSuccess) {
    successSound.play();
    gsap.to(bluedropSuccessMessage, {
      opacity: 1,
      scale: 1,
      duration: 0.5,
      ease: 'back.out(1.7)',
    });
  } else {
    errorSound.play();
    gsap.to(bluedropErrorMessage, {
      opacity: 1,
      scale: 1,
      duration: 0.5,
      ease: 'back.out(1.7)',
    });
    gsap.to(bluedropRetryButton, {
      opacity: 1,
      duration: 0.5,
      delay: 1,
    });
  }
  gsap.to(fluidBackground, {
    y: '-150%',
    scale: 2,
    opacity: 0,
    duration: 1.5,
    ease: 'power2.inOut',
  });
  if (isSuccess) {
    await new Promise(resolve => setTimeout(resolve, 2500));
    resetAnimation();
  }
}

function resetAnimation() {
  gsap.to([bluedropSuccessMessage, bluedropErrorMessage, bluedropRetryButton], {
    opacity: 0,
    scale: 0.8,
    duration: 0.5,
    ease: 'power2.inOut',
    onComplete: () => {
      gsap.set(fluidBackground, { clearProps: 'all' });
      gsap.set(bluedropMessage, { opacity: 1 });
      animateFluid();
      isAnimating = false;
    },
  });
}

// Event Listeners
blueDropButton.addEventListener('click', startBlueDrop);
blueDropClose.addEventListener('click', stopBlueDrop);
bluedropRetryButton.addEventListener('click', (e) => {
  e.stopPropagation();
  resetAnimation();
});
blueDropAnimation.addEventListener('click', startTransfer);
window.addEventListener('resize', resizeCanvas);

// GSAP Registration
gsap.registerPlugin(MotionPathPlugin);


  </script>
  
    <!-- JavaScript -->
  <script>
    const settingsIcon = document.getElementById('settings-icon');
    const popup = document.getElementById('popup');
    const closeBtn = document.getElementById('close-btn');
    const toggles = document.querySelectorAll('.toggle');

    // Open popup
    settingsIcon.addEventListener('click', () => {
      popup.classList.add('show');
      navigator.vibrate?.(50);
    });

    // Close popup
    closeBtn.addEventListener('click', () => {
      popup.classList.remove('show');
      navigator.vibrate?.(30);
    });

    // Toggle functionality
    toggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        toggle.classList.toggle('active');
        navigator.vibrate?.(50);
      });
    });
  </script>
</body>
</html>
